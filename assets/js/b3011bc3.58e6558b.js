"use strict";(self.webpackChunkintroduction_to_programming=self.webpackChunkintroduction_to_programming||[]).push([[1880],{6466:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"bash/loop","title":"Looping in Bash","description":"There are four types of loops in bash:","source":"@site/docs/07-bash/14-loop.md","sourceDirName":"07-bash","slug":"/bash/loop","permalink":"/OPS102/bash/loop","draft":false,"unlisted":false,"editUrl":"https://github.com/Seneca-ICTOER/OPS102/tree/main/docs/07-bash/14-loop.md","tags":[],"version":"current","sidebarPosition":14,"frontMatter":{},"sidebar":"courseNotesSidebar","previous":{"title":"Bash Example Scripts","permalink":"/OPS102/bash/bash-examples"},"next":{"title":"Windows vs. Linux Scripting","permalink":"/OPS102/cmd/cmd-vs-bash"}}');var o=s(4848),i=s(8453);const r={},a="Looping in Bash",l={},h=[{value:"for VARIABLE in LIST",id:"for-variable-in-list",level:2},{value:"The &quot;C-style&quot; for loop: for (( ; ; ))",id:"the-c-style-for-loop-for----",level:2},{value:"while EXPR",id:"while-expr",level:2},{value:"until EXPR",id:"until-expr",level:2},{value:"tput Colour Codes",id:"tput-colour-codes",level:2},{value:"Number-Guessing Game",id:"number-guessing-game",level:2}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"looping-in-bash",children:"Looping in Bash"})}),"\n",(0,o.jsx)(n.p,{children:"There are four types of loops in bash:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"for *VARIABLE* in *LIST*"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"for (( ; ; ))"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"while *EXPR*"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"until *EXPR*"})}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["In every case, the actual body of the loop is contained within ",(0,o.jsx)(n.em,{children:"do"})," ...\n",(0,o.jsx)(n.em,{children:"done"})," keywords."]}),"\n",(0,o.jsx)(n.h2,{id:"for-variable-in-list",children:"for VARIABLE in LIST"}),"\n",(0,o.jsxs)(n.p,{children:["This type of loop iterates through a list of values; the ",(0,o.jsx)(n.em,{children:"VARIABLE"})," is\nsequentially set to the each of the items in the list of values and the\nbody of the loop is executed for each value. The list of values may be\nconstants:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"for X in 1 2 3\ndo\n  ... body of the loop ...\ndone\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"for COLOUR in red green blue\ndo\n  ... body of the loop ...\ndone\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Or the list may be the list of parameters (arguments to the script),\nwritten as ",(0,o.jsx)(n.code,{children:'"$@"'}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'for A in "$@"\ndo\n  ... body of the loop ...\ndone\n'})}),"\n",(0,o.jsx)(n.p,{children:"The most common use of this type of loop may be one or more globbing patterns (filename patterns with wildcard characters), which will be replaced with a list of all matching filenames:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"for SOURCEFILE in *.c\ndo\n  ... body of the loop ...\ndone\n"})}),"\n",(0,o.jsxs)(n.p,{children:["One thing to remember with this last form of the loop is that ",(0,o.jsx)(n.em,{children:"if the pattern does not match any file"})," then the pattern itself will be assigned to the variable. For example, in the example above, if there are no files that match the pattern ",(0,o.jsx)(n.code,{children:"*.c"})," then the variable SOURCEFILE will be set to the actual pattern: ",(0,o.jsx)(n.code,{children:"SOURCEFILE=*.c"})]}),"\n",(0,o.jsx)(n.p,{children:"This can be used in various ways. For example, this loop will compile all of the C source files found in the current directory:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'for SOURCEFILE in *.c\ndo\n  echo "=== Compiling $SOURCEFILE ==="\n  \n  # This next line removes the extension from the filename\n  BINARY="$(echo $SOURCEFILE | cut -d. -f1)"\n  \n  gcc SOURCEFILE -o $BINARY\ndone\n'})}),"\n",(0,o.jsxs)(n.p,{children:["(It's also possible to generate the ",(0,o.jsx)(n.code,{children:"LIST"})," in other ways -- for example, from the output of another command, captured with ",(0,o.jsx)(n.code,{children:"$( )"})," )"]}),"\n",(0,o.jsx)(n.h2,{id:"the-c-style-for-loop-for----",children:'The "C-style" for loop: for (( ; ; ))'}),"\n",(0,o.jsxs)(n.p,{children:['This loop is very similar to the "for" loop available in the C language. The C parenthesis are changed to bash double-parenthesis, to invoke the bash arithmetic syntax, and the curly-braces ',(0,o.jsx)(n.code,{children:"{ }"})," used in C are replaced by the bash ",(0,o.jsx)(n.em,{children:"do"})," and ",(0,o.jsx)(n.em,{children:"done"})," keywords. The three arguments in the double-parenthesis are the initial condition (variable\ninitialization), the control condition (an expression that, while true, causes the loop to continue), and the increment/decrement (an expression which is executed at the end of each loop, which typically increments or decrements a counter)."]}),"\n",(0,o.jsx)(n.p,{children:"For example, this loop counts from 1 to 10:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"for (( i=0; i<=10; i++ ))\ndo\n  echo $i\ndone\n"})}),"\n",(0,o.jsx)(n.h2,{id:"while-expr",children:"while EXPR"}),"\n",(0,o.jsxs)(n.p,{children:["This loop continues as long as the expression ",(0,o.jsx)(n.em,{children:"EXPR"})," is true:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'while [[ "$A" == "$B" ]]\ndo\n  ... body of the loop ...\ndone\n'})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.em,{children:"EXPR"})," may be any single bash command, or a list of bash commands separated by newline characters (ENTER key) or semicolons, or a pipeline of commands. Most commonly it is a ",(0,o.jsx)(n.code,{children:"test"})," ",(0,o.jsx)(n.code,{children:"[[  ]]"})," command."]}),"\n",(0,o.jsx)(n.h2,{id:"until-expr",children:"until EXPR"}),"\n",(0,o.jsxs)(n.p,{children:["This loop continues as long as the expression ",(0,o.jsx)(n.em,{children:"EXPR"})," is false:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'until [[ "$X" -gt "$Y" ]]\ndo\n  ... body of the loop ...\ndone\n'})}),"\n",(0,o.jsxs)(n.p,{children:["This loop will continue as long as ",(0,o.jsx)(n.code,{children:"$X"})," is less than or equal to ",(0,o.jsx)(n.code,{children:"$Y"})," -- as soon as the expression becomes true (when ",(0,o.jsx)(n.code,{children:"$X"})," is greater than ",(0,o.jsx)(n.code,{children:"$Y"}),"), the loop will stop."]}),"\n",(0,o.jsx)(n.h1,{id:"examples",children:"Examples"}),"\n",(0,o.jsx)(n.p,{children:"Here are a few bash scripting examples that include loops:"}),"\n",(0,o.jsx)(n.h2,{id:"tput-colour-codes",children:"tput Colour Codes"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.em,{children:"tput"})," command outputs terminal codes to stdout to perform actions\nsuch as setting the text colour, clearing the screen, and so forth."]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsxs)(n.em,{children:["tput setaf ",(0,o.jsx)(n.em,{children:"n"})]})," and ",(0,o.jsxs)(n.em,{children:["tput setab ",(0,o.jsx)(n.em,{children:"n"})]})," commands set the\nforeground and background text colours, respectively. To see the\navailable colours, this script can be used:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'#!/usr/bin/bash\nfor ((C=0; C<16; C++))\ndo\n  tput setaf $C   # Set foreground to colour $C\n  echo "Colour $C"\ndone\ntput sgr0   # Reset to "normal" text mode\n'})}),"\n",(0,o.jsx)(n.h2,{id:"number-guessing-game",children:"Number-Guessing Game"}),"\n",(0,o.jsx)(n.p,{children:"This is the main example from the lecture. Study this code and\nensure that you understand what it does (tip: test it, and alter it to see\nwhat effect your changes have):"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'#!/usr/bin/bash\n\nMAX=100       # Maximum value of secret\nMAX_TRIES=7   # Maximum number of tries (guesses)\nGAMES=0       # How many games have been played\nWINS=0        # How many games the user has won\n\nclear     # Clear the screen\ntput setaf 5  # Select purple text\necho "=== Number-Guessing Game ==="\necho\necho "I have a secret number between 1 and $MAX"\necho "Your mission is to guess it in as few tries as possible."\necho "You have a maximum of $MAX_TRIES guesses to succeed."\necho\n\nPLAY="Y"\n# This next loop continues until the user says\n# they don\'t want to play again\nwhile [[ "$PLAY" == "Y" || "$PLAY" == "y" || "$PLAY" == "YES" ||\n     "$PLAY" == "Yes" || "$PLAY" == "yes" ]]\ndo\n      # Generate a random number from 1-MAX\n  SECRET=$(( RANDOM % MAX + 1 ))  \n\n      # Un-comment this line when debugging!\n      # echo "NOTE: the secret number is $SECRET"\n\n  GUESS=0\n  TRIES=0\n  ((GAMES++))\n\n  # This next loop continues until the user guess correctly\n  # or the maximum number of guesses is exhausted\n  until `[`| $TRIES -ge $MAX_TRIES `]($GUESS_-eq_$SECRET "wikilink")\\\n  do\n      tput setaf 15   # White text\n      read -p "Enter your guess (#$((++TRIES))): " GUESS\n      if `[`$GUESS -gt $SECRET`]($GUESS_-gt_$SECRET "wikilink")\\\n      then\n          tput setaf 1    # Red text\n          echo "Too high!"\n      elif `[`$GUESS -lt $SECRET`]($GUESS_-lt_$SECRET "wikilink")\\\n      then\n          tput setaf 1    # Red text\n          echo "Too low!"\n      else\n          tput setaf 10   # Green text\n          echo "You got it in $((TRIES)) tries!"\n          ((WINS++))\n      fi\n      echo\n  done\n  if `[`! $GUESS -eq $SECRET`](!_$GUESS_-eq_$SECRET "wikilink")\\\n  then\n      tput setaf 11   # Yellow text\n      echo "You lose after $TRIES attempts. The number was $SECRET. "\n  fi\n\n  tput setaf 15   # White text\n  echo \n  read -p "Do you want to play again (Y/N)? " PLAY\n  echo\n\ndone\ntput setaf 5  # Purple text\n\n# In the next line, the multiplication\n# must preceed the division because\n# this is integer math\necho "You executed $GAMES missions and succeeded $WINS times ($((WINS*100/GAMES))% success)."\n\necho\ntput sgr0 # Reset to normal text\n'})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var t=s(6540);const o={},i=t.createContext(o);function r(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);