"use strict";(self.webpackChunkintroduction_to_programming=self.webpackChunkintroduction_to_programming||[]).push([[8954],{8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var i=s(6540);const l={},r=i.createContext(l);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},8497:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"cmd/loop","title":"Looping","description":"In the Windows CMD shell, looping is performed with the FOR statement.","source":"@site/docs/08-cmd/11-loop.md","sourceDirName":"08-cmd","slug":"/cmd/loop","permalink":"/OPS102/cmd/loop","draft":false,"unlisted":false,"editUrl":"https://github.com/Seneca-ICTOER/OPS102/tree/main/docs/08-cmd/11-loop.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{},"sidebar":"courseNotesSidebar","previous":{"title":"Script Parameters","permalink":"/OPS102/cmd/param"},"next":{"title":"What are Regular Expressions?","permalink":"/OPS102/regex/what-why"}}');var l=s(4848),r=s(8453);const o={},t="Looping",a={},c=[{value:"Delayed Expansion",id:"delayed-expansion",level:2},{value:"Loop throush a List of Files or Parameters",id:"loop-throush-a-list-of-files-or-parameters",level:2},{value:"Example",id:"example",level:3},{value:"Loop through a Range of Integers",id:"loop-through-a-range-of-integers",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"looping",children:"Looping"})}),"\n",(0,l.jsxs)(n.p,{children:["In the Windows CMD shell, looping is performed with the ",(0,l.jsx)(n.em,{children:"FOR"})," statement."]}),"\n",(0,l.jsx)(n.p,{children:"Loops are controlled by an iterator variable, which has special rules:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["The iterator variable name must be a ",(0,l.jsx)(n.strong,{children:"single letter"})]}),"\n",(0,l.jsxs)(n.li,{children:["The variable name is ",(0,l.jsx)(n.strong,{children:"case sensitive"})]}),"\n",(0,l.jsx)(n.li,{children:"The variable name is written with a single preceeding percent sign\n[%] at all times when used from the command line, or double preceeding\npercent signs [%%] inside a script"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"delayed-expansion",children:"Delayed Expansion"}),"\n",(0,l.jsxs)(n.p,{children:["When the body of a ",(0,l.jsx)(n.em,{children:"FOR"})," loop is executed, the variables are expanded\n(replaced by their values) before the loop begins. That means that any\nvariables that are contained in the loop have their values locked-in and\nthey can't be changed while the loop is executing.\u200b"]}),"\n",(0,l.jsx)(n.p,{children:"To allow updated variable values to be accessed within a loop:\u200b"}),"\n",(0,l.jsx)(n.p,{children:"1. Set the EnableDelayedExpansion option:\u200b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"SETLOCAL EnableDelayedExpansion\u200b\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u200b2. Change any variables which will be updated during the execution of\nthe loop by replacing the percent-signs ( ",(0,l.jsx)(n.code,{children:"%"})," ) with exclaimation-marks (\n",(0,l.jsx)(n.code,{children:"!"})," ):\u200b"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"%ERRORLEVEL%    ->    !ERRORLEVEL!\u200b\n"})}),"\n",(0,l.jsx)(n.h2,{id:"loop-throush-a-list-of-files-or-parameters",children:"Loop throush a List of Files or Parameters"}),"\n",(0,l.jsx)(n.p,{children:"To loop through a list of values such as filenames, use:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"FOR %variable IN (files) DO list\u200b\n"})}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.em,{children:"variable"})," will be sequentially set to each of the given ",(0,l.jsx)(n.em,{children:"files"}),"\nvalues, and the loop body (",(0,l.jsx)(n.em,{children:"list"}),") will be executed once for each\nvalue."]}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.em,{children:"files"})," value may be:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["A list of filenames: ",(0,l.jsx)(n.code,{children:"FOR %F IN (file1.txt file2.pdf file3.c) DO ECHO %F"})]}),"\n",(0,l.jsxs)(n.li,{children:["A filename pattern: ",(0,l.jsx)(n.code,{children:"FOR %F IN (*.pdf) DO ECHO %F"})]}),"\n",(0,l.jsxs)(n.li,{children:["Fixed strings: ",(0,l.jsx)(n.code,{children:"FOR %C IN (Red Green Blue) DO ECHO %C"})]}),"\n",(0,l.jsxs)(n.li,{children:["Or a list of all of the parameters: ",(0,l.jsx)(n.code,{children:"FOR %P IN (%*) DO ECHO %P"})]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"/D"})," option can be used along with a filename pattern to match only\ndirectories:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"FOR /D %variable IN (files) DO list\n"})}),"\n",(0,l.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'@echo off\u200b\nSETLOCAL EnableDelayedExpansion\u200b\nFOR %%F IN (\\*) DO (\u200b\n\nrem The CHOICE command presents a Y/N choice and sets %ERRORLEVEL%\nrem to 1 if the user selected Y and 2 if the user selected N\n\nCHOICE /M "DELETE %%F"\u200b\nIF !ERRORLEVEL!==1 (\u200b\n  ECHO ...Deleting %%F\u200b\n  DEL %%F\u200b\n) ELSE (\u200b\n  ECHO ...Skipping %%F\u200b\n)\u200b\n'})}),"\n",(0,l.jsx)(n.h2,{id:"loop-through-a-range-of-integers",children:"Loop through a Range of Integers"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"FOR /L (start, step, end) DO list\n"})}),"\n",(0,l.jsxs)(n.p,{children:["This type of loop counts forward or backwards from ",(0,l.jsx)(n.em,{children:"start"})," to ",(0,l.jsx)(n.em,{children:"end"})," by\na given ",(0,l.jsx)(n.em,{children:"step"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"Example:\u200b \u200b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"@echo off\u200b\nrem Count from 0 to 5 in increments of 1\u200b\nFOR /L %%I IN (0,  1, 5) DO ECHO ... %%I ...\u200b\n \nrem Count from 4 to 0 in increments of -1\u200b\nFOR /L %%I IN (4, -1, 0) DO ECHO ... %%I ...\n"})}),"\n",(0,l.jsx)(n.p,{children:"Output:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-plain",children:"0\n1\n2\n3\n4\n5   <- This is the end of output from the first loop, having gone from 0 to 5\n4   <- The second loop starts output here, going from 4 to 0\n3\n2\n1\n0\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}}}]);